AGENTRC="$HOME/.ssh/agentrc"

unset SSH_AGENT_PID SSH_AUTH_SOCK

if test -f "$AGENTRC"; then
        eval `cat "$AGENTRC"`
        if test -z "$SSH_AGENT_PID" || 
          ! kill -0 $SSH_AGENT_PID || 
          ! pgrep ssh-agent |fgrep -qx $SSH_AGENT_PID
        then
                unset SSH_AGENT_PID
        fi
fi

if test -z "$SSH_AGENT_PID"; then
        ssh-agent >"$AGENTRC"
        . `cat "$AGENTRC"`
	ssh-add
fi
